<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    PHP基础学习笔记(中) | buzi
</title>
<link rel="shortcut icon" href="https://littlebuzi.github.io//favicon.ico?v=1620229439110">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://littlebuzi.github.io//styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://littlebuzi.github.io//media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
            
                <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
                <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
                

                    
                            
</head>

<body>
    <div class="main">
        <style>

.header-navigation {
	position:fixed;
	top:0;
	width:100%;
	height:60px;
	line-height:60px;
	background-color:#333;
	text-align:center;
	box-shadow:0 14px 28px rgba(0,0,0,0.25),0 10px 10px rgba(0,0,0,0.22);
	z-index:9999;
}

/* Slide transitions */

	.slideUp {
	/* -webkit-transform:translateY(-100px);
	transform:translateY(-100px);
	*/
	  -webkit-transform:translateY(-100px);
	-ms-transform:translateY(-100px);
	-o-transform:translateY(-100px);
	transform:translateY(-100px);
	/*transition:transform .5s ease-out;
	*/
	  -webkit-transition:transform .5s ease-out;
	-o-transition:transform .5s ease-out;
	transition:transform .5s ease-out;
}
.slideDown {
	/*-webkit-transform:translateY(0);
	transform:translateY(0);
	*/
	  -webkit-transform:translateY(0);
	-ms-transform:translateY(0);
	-o-transform:translateY(0);
	transform:translateY(0);
	/*transition:transform .5s ease-out;
	*/
	  -webkit-transition:transform .5s ease-out;
	-o-transition:transform .5s ease-out;
	transition:transform .5s ease-out;
}
</style>

<div class="header" class="header-navigation" id="header">
    <div class="nav">
        <div class="logo">
            <a href="https://littlebuzi.github.io/">
                <img class="avatar" src="https://littlebuzi.github.io//images/avatar.png?v=1620229439110" alt="">
            </a>
            <div class="site-title">
                <h1>
                    buzi
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    时间线
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    分类
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="https://littlebuzi.github.io/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
var new_scroll_position = 0;
var last_scroll_position;
var header = document.getElementById("header");

window.addEventListener('scroll', function(e) {
    last_scroll_position = window.scrollY;

    // Scrolling down
    if (new_scroll_position < last_scroll_position && last_scroll_position > 80) {
        // header.removeClass('slideDown').addClass('slideUp');
        header.classList.remove("slideDown");
        header.classList.add("slideUp");

        // Scrolling up
    } else if (new_scroll_position > last_scroll_position) {
        // header.removeClass('slideUp').addClass('slideDown');
        header.classList.remove("slideUp");
        header.classList.add("slideDown");
    }

    new_scroll_position = last_scroll_position;
});
</script>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            PHP基础学习笔记(中)
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2020-04-11</time>
                            
                                <a href="https://littlebuzi.github.io/O2zTJWpBN/" class="post-tag i-tag
                            i-tag-other_3">
                            #php
                        </a>
                                
                        </div>
                        
                            <div class="post-feature-image" style="background-image: url('https://littlebuzi.github.io//post-images/learn_php_2.jpg')"></div>
                            
                                <div class="post-content">
                                    <blockquote>
<p>本文章是继PHP基础学习笔记（上）的下篇，主要记录php基础知识，资源整合自慕课网。</p>
</blockquote>
<hr>
<h1 id="一-数组定义">一、数组定义</h1>
<p>数组就是一个键值对组成的语言结构，键类似于酒店的房间号，值类似于酒店房间里存储的东西。</p>
<pre><code class="language-php">$arr = array();
</code></pre>
<p>表示创建一个空数组，并把创建的空数组赋值给变量$arr。</p>
<h2 id="索引数组初始化">索引数组初始化</h2>
<p>PHP有两种数组：索引数组、关联数组。<br>
索引和关联两个词都是针对数组的键而言的。</p>
<p>索引数组是指数组的键是整数的数组，并且键的整数顺序是从0开始，依次类推。</p>
<pre><code class="language-php">fruit
|香蕉|苹果|雪梨|
|:-|:-:|-:|
|0|1|2|

$fruit = array(&quot;苹果&quot;,&quot;香蕉&quot;,&quot;菠萝&quot;); 
print_r($fruit);
</code></pre>
<h2 id="索引数组赋值">索引数组赋值</h2>
<p>赋值有三种方式:</p>
<pre><code class="language-php">$arr[0]='苹果';
array('0'=&gt;'苹果');
$arr = array('0'=&gt;'苹果');
if( isset($arr) ) {print_r($arr);}
</code></pre>
<p>isset（） 函数是检查 括号内的是否被定义了，定义为null 也表示true。</p>
<h2 id="索引数组内容">索引数组内容</h2>
<pre><code class="language-php">$fruit = array('苹果','香蕉');
$fruit0 = $fruit['0'];
print_r($fruit0);//结果为苹果
</code></pre>
<h2 id="循环访问索引数组里的值">循环访问索引数组里的值</h2>
<pre><code class="language-php">$fruit=array('苹果','香蕉','菠萝');

// for循环
for($i=0; $i&lt;3; $i++){
    echo '&lt;br&gt;数组第'.$i.'值是：'.$fruit[$i];
}

//foreach循环
foreach($fruit as $key=&gt;$value){
    echo '&lt;br&gt;第'.$key.'值是：';
}
</code></pre>
<h2 id="关联数组初始化">关联数组初始化</h2>
<pre><code class="language-php">// 创建一个关联数组，关联数组的键“orange”，值是“橘子”
$fruit = array(
    // 关联数组赋值
    'apple'=&gt;&quot;苹果&quot;,
    'banana'=&gt;&quot;香蕉&quot;,
    'pineapple'=&gt;&quot;菠萝&quot;
); 

// 访问关联数组内容
$fruit0 = $fruit['banana'];
print_r($fruit0);

// foreach循环访问关联数组里的值
foreach($fruit as $k=&gt;$v){
    echo '&lt;br&gt;水果的英文键名：'.$k.'，对应的值是：'.$v;
</code></pre>
<h1 id="二-类和对象">二、类和对象</h1>
<p>类是面向对象程序设计的基本概念，通俗的理解类就是对现实中某一个种类的东西的抽象。<br>
如汽车可以抽象为一个类，<br>
属性：名字、轮胎、速度、重量等，<br>
操作方法：换挡、前进、后退等。</p>
<pre><code class="language-php">// 定义一个汽车类的方法为
class Car {
    $name = '汽车'; //定义属性
    function getName() { //定义方法
        return $this-&gt;name; //方法内部可以使用$this伪变量调用对象的属性或者方法
    }
}
// 类是一类东西的结构描述，而对象则是一类东西的一个具体实例，
// 例如汽车这个名词可以理解为汽车的总类，但这辆汽车则是一个具体的汽车对象。

// 对象通过new关键字进行实例化：
$car = new Car();
$car-&gt;name = '奥迪A6'; //设置对象的属性值
echo $car-&gt;getName();  //调用对象的方法 输出对象的名字

//也可以采用变量来创建
$className = 'Car';
$car = new $className();

//类与对象看起来比较相似，但实际上有本质的区别，
//类是抽象的概念，对象是具体的实例。
//类可以使程序具有可重用性。
</code></pre>
<h2 id="对象之类的属性">对象之类的属性</h2>
<p>在类中定义的变量称之为属性，<br>
通常属性跟数据库中的字段有一定的关联，因此也可以称作“字段”。<br>
属性声明是由以下关键字开头。<br>
<code>public：公开的</code><br>
<code>protected：受保护的</code><br>
<code>private：私有的</code></p>
<pre><code class="language-php">class Car {
    //定义公共属性
    public $name = '汽车';

    //定义受保护的属性
    protected $color = '白色';

    //定义私有属性
    private $price = '100000';
}
</code></pre>
<p>默认都为public，外部可以访问。<br>
一般通过-&gt;对象操作符来访问对象的属性或者方法，对于静态属性则使用::双冒号进行访问。<br>
当在类成员方法内部调用的时候，可以使用$this伪变量调用当前对象的属性。</p>
<pre><code class="language-php">$car = new Car();
echo $car-&gt;name;   //调用对象的属性
echo $car-&gt;color;  //错误 受保护的属性不允许外部调用
echo $car-&gt;price;  //错误 私有属性不允许外部调用

受保护的属性与私有属性不允许外部调用，在类的成员方法内部是可以调用的。

class Car{
    private $price = '1000';
    public function getPrice() {
        return $this-&gt;price; //内部访问私有属性
​    }
}
</code></pre>
<h2 id="定义类的方法">定义类的方法</h2>
<p>方法就是在类中的function，很多时候我们分不清方法与函数有什么差别，<br>
在面向过程的程序设计中function叫做<code>函数</code>，在面向对象中function则被称之为<code>方法</code>。</p>
<p>同属性一样，类的方法也具有public，protected 以及 private 的访问控制。</p>
<p>被定义为公有的类成员可以在任何地方被访问。<br>
被定义为受保护的类成员则可以被其自身以及其子类和父类访问。<br>
被定义为私有的类成员则只能被其定义所在的类访问。</p>
<pre><code class="language-php">class Car {
    public function getName() {
        return '汽车';
    }
​}
$car = new Car();
echo $car-&gt;getName();
</code></pre>
<p>使用关键字static修饰的，称之为静态方法。<br>
静态方法不需要实例化对象，可以通过类名直接调用，操作符为双冒号::。</p>
<pre><code class="language-php">class Car {
    public static function getName() {
        return '汽车';
    }
​}
echo Car::getName(); //结果为“汽车”

// 静态方法也可以通过变量来进行动态调用

$func = 'getSpeed';
$className = 'Car';
echo $className::$func();  //动态调用静态方法

静态方法中，$this伪变量不允许使用。
可以使用self，parent，static在内部调用静态方法与属性。

class Car {
    private static $speed = 10;
    
    public static function getSpeed() {
        return self::$speed;
    }
    
    public static function speedUp() {
        return self::$speed+=10;
    }
}
class BigCar extends Car {
    public static function start() {
        parent::speedUp();
    }
}

BigCar::start();
echo BigCar::getSpeed();

车辆加速

class Car {
    private static $speed = 10;
    
    public function getSpeed() {
        return self::$speed;
    }
    
    //在这里定义一个静态方法，实现速度累加10

public static function speedUp() {
    return self::$speed+=10;
}

}

$car = new Car();
Car::speedUp();  //调用静态方法加速
echo $car-&gt;getSpeed();  //调用共有方法输出当前的速度值
</code></pre>
<h2 id="构造函数和析构函数">构造函数和析构函数</h2>
<p>__construct()定义一个构造函数，具有构造函数的类，<br>
会在每次对象创建的时候调用该函数，因此常用来在对象创建的时候进行一些<code>初始化工作</code>。</p>
<pre><code class="language-php">class Car {
   function __construct() {
       print &quot;构造函数被调用\n&quot;;
   }
}
$car = new Car(); //实例化的时候 会自动调用构造函数__construct，这里会输出一个字符串
</code></pre>
<p>在子类中如果定义了__construct则不会调用父类的__construct，<br>
如果需要同时调用父类的构造函数，需要使用parent::__construct()显式的调用。</p>
<pre><code class="language-php">class Car {
   function __construct() {
       print &quot;父类构造函数被调用\n&quot;;
   }
}
class Truck extends Car {
   function __construct() {
       print &quot;子类构造函数被调用\n&quot;;
       parent::__construct();
   }
}
$car = new Truck();
</code></pre>
<p>同样，PHP5支持析构函数，使用__destruct()进行定义,<br>
析构函数指的是当某个对象的所有引用被删除，或者对象被显式的销毁时会执行的函数。</p>
<pre><code class="language-php">class Car {
   function __construct() {
       print &quot;构造函数被调用 \n&quot;;
   }
   function __destruct() {
       print &quot;析构函数被调用 \n&quot;;
   }
}
$car = new Car(); //实例化时会调用构造函数
echo '使用后，准备销毁car对象 \n';
unset($car); //销毁时会调用析构函数
</code></pre>
<p>当PHP代码执行完毕以后，会自动回收与销毁对象，因此一般情况下不需要显式的去销毁对象。</p>
<h2 id="访问控制">访问控制</h2>
<p>类属性必须定义为公有、受保护、私有之一。<br>
为兼容PHP5以前的版本，如果采用 var 定义，则被视为公有。</p>
<pre><code class="language-php">class Car {
    $speed = 10; //错误 属性必须定义访问控制
    public $name;   //定义共有属性
}
</code></pre>
<p>类中的方法可以被定义为公有、私有或受保护。<br>
如果没有设置这些关键字，则该方法默认为<code>公有</code>。</p>
<pre><code class="language-php">class Car {
​    //默认为共有方法
    function turnLeft() {
    }
}
</code></pre>
<p>如果构造函数定义成了私有方法，则不允许直接实例化对象了，<br>
这时候一般通过静态方法进行实例化，在设计模式中会经常使用这样的方法来控制对象的创建，<br>
比如单例模式只允许有一个全局唯一的对象。</p>
<pre><code class="language-php">class Car {
    private function __construct() {
        echo 'object create';
    }

    private static $_object = null;
    public static function getInstance() {
        if (empty(self::$_object)) {
            self::$_object = new Car(); //内部方法可以调用私有方法，因此这里可以创建对象
        }
        return self::$_object;
    }
}
//$car = new Car(); //这里不允许直接实例化对象
$car = Car::getInstance(); //通过静态方法来获得一个实例
</code></pre>
<h2 id="对象继承">对象继承</h2>
<p>继承是面向对象程序设计中常用的一个特性，汽车是一个比较大的类，我们也可以称之为基类，<br>
除此之外，汽车还分为卡车、轿车、东风、宝马等，因为这些子类具有很多相同的属性和方法，<br>
可以采用继承汽车类来共享这些属性与方法，实现代码的复用。</p>
<pre><code class="language-php">class Car {
    public $speed = 0; //汽车的起始速度是0
    
    public function speedUp() {
        $this-&gt;speed += 10;
        return $this-&gt;speed;
    }
}
//定义继承于Car的Truck类
class Truck extends Car {
    public function speedUp(){
        $this-&gt;speed = parent::speedUp() + 50;
    }
}

$car = new Truck();
$car-&gt;speedUp();
echo $car-&gt;speed;

//结果：60
</code></pre>
<h2 id="重载">重载</h2>
<p>PHP中的重载指的是<code>动态</code>的创建属性与方法，是通过魔术方法来实现的。</p>
<p>__set，对不存在属性赋值<br>
__get，对不存在属性读取<br>
__isset，判断属性是否设置<br>
__unset，销毁属性</p>
<p>方法的重载通过__call来实现，当调用不存在的方法的时候，<br>
将会转为参数调用__call方法，当调用不存在的静态方法时会使用__callStatic重载。</p>
<pre><code class="language-php">class Car {
    public $speed = 10;

    //在这里使用重载实现speedDown方法
    public function __call($name, $args) {
        if ($name == 'speedDown') {
            $this-&gt;speed -= 10;
        }
    }
}
$car = new Car();
$car-&gt;speedDown(); //调用不存在的speedDown方法
echo $car-&gt;speed;

// $name 参数是要调用的方法名称。
// $arg 参数是一个枚举数组，包含着要传递给方法 $name 的参数。
// 所有的重载方法都必须被声明为 public。
//这些魔术方法的参数都不能通过引用传递。
//属性重载只能在对象中进行。在静态方式中，这些魔术方法将不会被调用。所以这些方法都不能被声明为 static。
</code></pre>
<p>详细：https://www.imooc.com/code/546</p>
<h2 id="高级特性">高级特性</h2>
<pre><code class="language-php">class Car {
    public $name = 'car';
    
    public function __clone() {
        $obj = new Car();
        $obj-&gt;name = $this-&gt;name;
    }
}
$a = new Car();
$a-&gt;name = 'new car';
$b = clone $a;
if ($a == $b) echo '==';   //true
if ($a === $b) echo '==='; //false

$str = serialize($a); //对象序列化成字符串
echo $str.'&lt;br&gt;';
$c = unserialize($str); //反序列化为对象
var_dump($c);
</code></pre>
<p>详细：https://www.imooc.com/code/547</p>
<hr>
<h1 id="三-正则表达式">三、正则表达式</h1>
<p>正则表达式是对字符串进行操作的一种逻辑公式，<br>
就是用一些特定的字符组合成一个规则字符串，称之为正则匹配模式。</p>
<pre><code class="language-php">$p = '/apple/';
$str = &quot;apple banna&quot;;
if (preg_match($p, $str)) {
    echo 'matched';
}
</code></pre>
<p>其中字符串'/apple/'就是一个正则表达式，用于匹配源字符串中是否存在apple字符串。</p>
<p>PHP中使用PCRE库函数进行正则匹配，比如上例中的preg_match用于执行一个正则匹配，<br>
常用来判断一类字符模式是否存在。</p>
<h2 id="基本语法">基本语法</h2>
<p>PCRE库函数中，正则匹配模式使用分隔符与元字符组成，分隔符可以是非数字、非反斜线、非空格的任意字符。经常使用的分隔符是正斜线(/)、hash符号(#) 以及取反符号(~)，例如：</p>
<pre><code class="language-php">/foo bar/
#^[^0-9]$#
~php~

//如果模式中包含分隔符，则分隔符需要使用反斜杠（\）进行转义。

/http:\/\//

//如果模式中包含较多的分割字符，建议更换其他的字符作为分隔符，也可以采用preg_quote进行转义。

$p = 'http://';
$p = '/'.preg_quote($p, '/').'/';
echo $p;

//分隔符后面可以使用模式修饰符，模式修饰符包括：i, m, s, x等，
//例如使用i修饰符可以忽略大小写匹配：

$str = &quot;Http://www.imooc.com/&quot;;
if (preg_match('/http/i', $str)) {
    echo '匹配成功';
}

// 忽略大小写匹配BBC
$p = '/bbc/i';
$str = &quot;BBC是英国的一个电视台&quot;;
if (preg_match($p, $str)) {
    echo '匹配成功';
}

</code></pre>
<h2 id="元字符与转义">元字符与转义</h2>
<p>正则表达式中具有特殊含义的字符称之为元字符，常用的元字符有：</p>
<p>\ 一般用于转义字符<br>
^ 断言目标的开始位置(或在多行模式下是行首)<br>
$ 断言目标的结束位置(或在多行模式下是行尾)<br>
. 匹配除换行符外的任何字符(默认)<br>
[ 开始字符类定义<br>
] 结束字符类定义<br>
| 开始一个可选分支<br>
( 子组的开始标记<br>
) 子组的结束标记<br>
? 作为量词，表示 0 次或 1 次匹配。位于量词后面用于改变量词的贪婪特性。 (查阅量词)</p>
<ul>
<li>量词，0 次或多次匹配</li>
</ul>
<ul>
<li>量词，1 次或多次匹配<br>
{ 自定义量词开始标记<br>
} 自定义量词结束标记</li>
</ul>
<p>//下面的\s匹配任意的空白符，包括空格，制表符，换行符。[<sup>\s]代表非空白符。[</sup>\s]+表示一次或多次匹配非空白符。</p>
<pre><code class="language-php">$p = '/^我[^\s]+(苹果|香蕉)$/';
$str = &quot;我喜欢吃苹果&quot;;
if (preg_match($p, $str)) {
    echo '匹配成功';
}
</code></pre>
<p>元字符具有两种使用场景，一种是可以在任何地方都能使用，另一种是只能在方括号内使用，在方括号内使用的有：</p>
<p>\ 转义字符<br>
^ 仅在作为第一个字符(方括号内)时，表明字符类取反</p>
<ul>
<li>标记字符范围</li>
</ul>
<p>其中^在反括号外面，表示断言目标的开始位置，但在方括号内部则代表字符类取反，方括号内的减号-可以标记字符范围，例如0-9表示0到9之间的所有数字。</p>
<pre><code class="language-php">//下面的\w匹配字母或数字或下划线。
$p = '/[\w\.\-]+@[a-z0-9\-]+\.(com|cn)/';
$str = &quot;我的邮箱是Spark.eric@imooc.com&quot;;
preg_match($p, $str, $match);
echo $match[0];

//匹配str中的电话
$p = '/\d+\-\d+/';
$str = &quot;我的电话是010-12345678&quot;;
preg_match($p, $str, $match);
echo $match[0];
</code></pre>
<h2 id="贪婪模式与懒惰模式">贪婪模式与懒惰模式</h2>
<p>正则表达式中每个元字符匹配一个字符，当使用+之后将会变的贪婪，它将匹配尽可能多的字符，<br>
但使用问号?字符时，它将尽可能少的匹配字符，既是懒惰模式。</p>
<p>贪婪模式：在可匹配与可不匹配的时候，优先匹配</p>
<pre><code class="language-php">//下面的\d表示匹配数字
$p = '/\d+\-\d+/';
$str = &quot;我的电话是010-12345678&quot;;
preg_match($p, $str, $match);
echo $match[0]; //结果为：010-12345678
</code></pre>
<p>懒惰模式：在可匹配与可不匹配的时候，优先不匹配</p>
<pre><code class="language-php">$p = '/\d?\-\d?/';
$str = &quot;我的电话是010-12345678&quot;;
preg_match($p, $str, $match);
echo $match[0];  //结果为：0-1
</code></pre>
<p>当我们确切的知道所匹配的字符长度的时候，可以使用{}指定匹配字符数</p>
<pre><code class="language-php">$p = '/\d{3}\-\d{8}/';
$str = &quot;我的电话是010-12345678&quot;;
preg_match($p, $str, $match);
echo $match[0]; //结果为：010-12345678
</code></pre>
<p>匹配str中的姓名</p>
<pre><code class="language-php">$p = '/name:([\w\s]+)/';
$str = &quot;name:steven jobs&quot;;
preg_match($p, $str, $match);
echo $match[1]; //结果为：steven jobs
</code></pre>
<h2 id="正则表达式匹配">正则表达式匹配</h2>
<pre><code class="language-php">//正则匹配，并输出邮箱地址,匹配email的方法还有有很多
$subject = &quot;my email is spark@imooc.com&quot;;
$pattern = '/[\w\-]+@\w+\.\w+/';
preg_match($pattern, $subject, $matches);
echo $matches[0];
</code></pre>
<p>详细：https://www.imooc.com/code/562</p>
<h2 id="查找所有匹配结果">查找所有匹配结果</h2>
<p>preg_match只能匹配一次结果，但很多时候我们需要匹配所有的结果，<br>
preg_match_all可以循环获取一个列表的匹配结果数组。</p>
<pre><code class="language-php">$str = &quot;&lt;ul&gt;
            &lt;li&gt;item 1&lt;/li&gt;
            &lt;li&gt;item 2&lt;/li&gt;
        &lt;/ul&gt;&quot;;
//在这里补充代码，实现正则匹配所有li中的数据

$p = &quot;/&lt;li&gt;(.*)&lt;\/li&gt;/i&quot;;//解释下这个正则：
//后面的i表示不区分大小写，&lt;li&gt;(.*?)&lt;\/li&gt;表示li标签内的匹配的()内的值有多少，
括号内的.表示所有单字符,*表示数量为0个或者多个。也就是li标签内有字符就显示出来
preg_match_all($p, $str, $matches);
print_r($matches[1]);

结果：
Array
(
    [0] =&gt; item 1
    [1] =&gt; item 2
)
</code></pre>
<p>详细：https://www.imooc.com/code/563</p>
<h2 id="正则表达式的搜索和替换">正则表达式的搜索和替换</h2>
<pre><code class="language-php">$str = '主要有以下几个文件：index.php, style.css, common.js';
//将目标字符串$str中的文件名替换后增加em标签

$p = '/\w+\.\w+/i';
$str = preg_replace($p, '&lt;em&gt;$0&lt;/em&gt;', $str);
echo $str;
结果：
主要有以下几个文件：index.php, style.css, common.js
</code></pre>
<h2 id="常用案例">常用案例</h2>
<pre><code class="language-php">$user = array(
    'name' =&gt; 'spark1985',
    'email' =&gt; 'spark@imooc.com',
    'mobile' =&gt; '13312345678'
);
//进行一般性验证
if (empty($user)) {
    die('用户信息不能为空');
}
if (strlen($user['name']) &lt; 6) {
    die('用户名长度最少为6位');
}
//用户名必须为字母、数字与下划线
if (!preg_match('/^\w+$/i', $user['name'])) {
    die('用户名不合法');
}
//验证邮箱格式是否正确
if (!preg_match('/^[\w\.]+@\w+\.\w+$/i', $user['email'])) {
    die('邮箱不合法');
}
//手机号必须为11位数字，且为1开头
if (!preg_match('/^1\d{10}$/i', $user['mobile'])) {
    die('手机号不合法');
}
echo '用户信息验证成功';
</code></pre>
<hr>
<h1 id="四-cookie">四、cookie</h1>
<p>Cookie是存储在客户端浏览器中的数据，我们通过Cookie来跟踪与存储用户数据。<br>
一般情况下，Cookie通过HTTP headers从服务端返回到客户端。<br>
多数web程序都支持Cookie的操作，因为Cookie是存在于HTTP的标头之中，<br>
所以必须在其他信息输出以前进行设置，类似于header函数的使用限制。</p>
<p>PHP通过setcookie函数进行Cookie的设置，任何从浏览器发回的Cookie，PHP都会自动的将他存储在<code>$_COOKIE</code>的全局变量之中，因此我们可以通过<code>$_COOKIE['key']</code>的形式来读取某个Cookie值。</p>
<p>PHP中的Cookie具有非常广泛的使用，经常用来存储用户的登录信息，购物车等，且在使用会话Session时通常使用Cookie来存储会话id来识别用户，Cookie具备有效期，当有效期结束之后，Cookie会自动的从客户端删除。同时为了进行安全控制，Cookie还可以设置域跟路径，我们会在稍后的章节中详细的讲解他们。</p>
<pre><code class="language-php">setcookie('test', time());
ob_start();
print_r($_COOKIE); 
$content = ob_get_contents();
$content = str_replace(&quot; &quot;, '&amp;nbsp;', $content);
ob_clean();
header(&quot;content-type:text/html; charset=utf-8&quot;);
echo '当前的Cookie为：&lt;br&gt;';
echo nl2br($content);
</code></pre>
<h2 id="设置cookie">设置cookie</h2>
<p>PHP设置Cookie最常用的方法就是使用setcookie函数，setcookie具有7个可选参数，</p>
<p>我们常用到的为前5个：</p>
<p>name（ Cookie名）可以通过$_COOKIE['name'] 进行访问<br>
value（Cookie的值）<br>
expire（过期时间）Unix时间戳格式，默认为0，表示浏览器关闭即失效<br>
path（有效路径）如果路径设置为'/'，则整个网站都有效<br>
domain（有效域）默认整个域名都有效，如果设置了'www.imooc.com',则只在www子域中有效</p>
<pre><code class="language-php">$value = 'test';
setcookie(&quot;TestCookie&quot;, $value);
setcookie(&quot;TestCookie&quot;, $value, time()+3600);  //有效期一小时
setcookie(&quot;TestCookie&quot;, $value, time()+3600, &quot;/path/&quot;, &quot;imooc.com&quot;); //设置路径与域
</code></pre>
<p>PHP中还有一个设置Cookie的函数setrawcookie，setrawcookie跟setcookie基本一样，<br>
唯一的不同就是value值不会自动的进行urlencode，因此在需要的时候要手动的进行urlencode。</p>
<pre><code class="language-php">setrawcookie('cookie_name', rawurlencode($value), time()+60*60*24*365); 
</code></pre>
<p>因为Cookie是通过HTTP标头进行设置的，所以也可以直接使用header方法进行设置。</p>
<pre><code class="language-php">header(&quot;Set-Cookie:cookie_name=value&quot;);
</code></pre>
<p>设置一个名为test的Cookie</p>
<pre><code class="language-php">$value = time();
setcookie('test', $value); 
if (isset($_COOKIE['test'])) {
    echo 'success';
}
</code></pre>
<h2 id="删除与过期时间">删除与过期时间</h2>
<pre><code class="language-php">setcookie('test', time());
//在这里试着删除test的cookie值
setcookie('test', '', time()-1); 
var_dump($_COOKIE);
</code></pre>
<p>将cookie的过期时间设置到当前时间之前，则该cookie会自动失效，也就达到了删除cookie的目的。<br>
之所以这么设计是因为cookie是通过HTTP的标头来传递的，客户端根据服务端返回的Set-Cookie段来进行cookie的设置，如果删除cookie需要使用新的Del-Cookie来实现，则HTTP头就会变得复杂，<br>
实际上仅通过Set-Cookie就可以简单明了的实现Cookie的设置、更新与删除。</p>
<p>了解原理以后，我们也可以直接通过header来删除cookie。</p>
<p>header(&quot;Set-Cookie:test=1393832059; expires=&quot;.gmdate('D, d M Y H:i:s \G\M\T', time()-1));</p>
<p>这里用到了gmdate，用来生成格林威治标准时间，以便排除时差的影响。</p>
<h2 id="有效路径">有效路径</h2>
<p>cookie中的路径用来控制设置的cookie在哪个路径下有效，默认为'/'，<br>
在所有路径下都有，当设定了其他路径之后，则只在设定的路径以及子路径下有效，例如：</p>
<pre><code class="language-php">setcookie('test', time(), 0, '/path');
</code></pre>
<p>上面的设置会使test在/path以及子路径/path/abc下都有效，但是在根目录下就读取不到test的cookie值。</p>
<p>一般情况下，大多是使用所有路径的，只有在极少数有特殊需求的时候，会设置路径，<br>
这种情况下只在指定的路径中才会传递cookie值，可以节省数据的传输，增强安全性以及提高性能。</p>
<p>当我们设置了有效路径的时候，不在当前路径的时候则看不到当前cookie。</p>
<pre><code class="language-php">setcookie('test', '1',0, '/path');  
var_dump($_COOKIE['test']);  
</code></pre>
<h2 id="session与cookie的异同">session与cookie的异同</h2>
<p>cookie将数据存储在客户端，建立起用户与服务器之间的联系，<br>
通常可以解决很多问题，但是cookie仍然具有一些局限：</p>
<p>cookie相对不是太安全，容易被盗用导致cookie欺骗<br>
单个cookie的值最大只能存储4k<br>
每次请求都要进行网络传输，占用带宽</p>
<p>session是将用户的会话数据存储在服务端，没有大小限制，通过一个session_id进行用户识别，PHP默认情况下session id是通过cookie来保存的，因此从某种程度上来说，seesion依赖于cookie。但这不是绝对的，session id也可以通过参数来实现，只要能将session id传递到服务端进行识别的机制都可以使用session。</p>
<pre><code class="language-php">使用session

//先执行session_start方法开启session
session_start();
//设置一个session，然后通过全局变量$_SESSION进行session的读写
$_SESSION['test'] = time();
//显示当前的session_id
echo &quot;session_id:&quot;.session_id();
echo &quot;&lt;br&gt;&quot;;

//读取session值
echo $_SESSION['test'];
// var_dump($_SESSION);

//删除与销毁一个session
unset($_SESSION['test']);
echo &quot;&lt;br&gt;&quot;;
var_dump($_SESSION);
//如果要删除所有的session，可以使用session_destroy函数销毁当前session，
//session_destroy会删除所有数据，但是session_id仍然存在。

session_start();
$_SESSION['name'] = 'jobs';
$_SESSION['time'] = time();
session_destroy();

//session_destroy并不会立即的销毁全局变量$_SESSION中的值，只有当下次再访问的时候，
//$_SESSION才为空，因此如果需要立即销毁$_SESSION，可以使用unset函数。

session_start();
$_SESSION['name'] = 'jobs';
$_SESSION['time'] = time();
unset($_SESSION);
session_destroy(); 
var_dump($_SESSION); //此时已为空

//如果需要同时销毁cookie中的session_id，通常在用户退出的时候可能会用到，
//则还需要显式的调用setcookie方法删除session_id的cookie值。
</code></pre>
<p>session会自动的对要设置的值进行encode与decode，<br>
因此session可以支持任意数据类型，包括数据与对象等。</p>
<p>session_start();<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow></mrow><mi>S</mi></msub><mi>E</mi><mi>S</mi><mi>S</mi><mi>I</mi><mi>O</mi><mi>N</mi><msup><mo>[</mo><mo mathvariant="normal">′</mo></msup><mi>a</mi><mi>r</mi><msup><mi>y</mi><mo mathvariant="normal">′</mo></msup><mo>]</mo><mo>=</mo><mi>a</mi><mi>r</mi><mi>r</mi><mi>a</mi><mi>y</mi><msup><mo>(</mo><mo mathvariant="normal">′</mo></msup><mi>n</mi><mi>a</mi><mi>m</mi><msup><mi>e</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><msup><mo>&gt;</mo><mo mathvariant="normal">′</mo></msup><mi>j</mi><mi>o</mi><mi>b</mi><msup><mi>s</mi><mo mathvariant="normal">′</mo></msup><mo>)</mo><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">_SESSION[&#x27;ary&#x27;] = array(&#x27;name&#x27; =&gt; &#x27;jobs&#x27;);
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen"><span class="mopen">[</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="mrel"><span class="mrel">&gt;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">;</span></span></span></span>_SESSION['obj'] = new stdClass();<br>
var_dump($_SESSION);<br>
默认情况下，session是以文件形式存储在服务器上的，因此当一个页面开启了session之后，会独占这个session文件，这样会导致当前用户的其他并发访问无法执行而等待。可以采用缓存或者数据库的形式存储来解决这个问题，</p>
<h2 id="session来存储用户的登录信息">session来存储用户的登录信息</h2>
<p>session可以用来存储多种类型的数据，因此具有很多的用途，<br>
常用来存储用户的登录信息，购物车数据，或者一些临时使用的暂存数据等。</p>
<p>用户在登录成功以后，通常可以将用户的信息存储在session中，<br>
一般的会单独的将一些重要的字段单独存储，然后所有的用户信息独立存储。</p>
<pre><code class="language-php">$_SESSION['uid'] = $userinfo['uid'];
$_SESSION['userinfo'] = $userinfo;
</code></pre>
<p>一般来说，登录信息既可以存储在sessioin中，也可以存储在cookie中，<br>
他们之间的差别在于session可以方便的存取多种数据类型，而cookie只支持字符串类型，<br>
同时对于一些安全性比较高的数据，cookie需要进行格式化与加密存储，而session存储在服务端则安全性较高。</p>
<pre><code class="language-php">session_start();
//假设用户登录成功获得了以下用户数据
$userinfo = array(
    'uid'  =&gt; 10000,
    'name' =&gt; 'spark',
    'email' =&gt; 'spark@imooc.com',
    'sex'  =&gt; 'man',
    'age'  =&gt; '18'
);
header(&quot;content-type:text/html; charset=utf-8&quot;);

/* 将用户信息保存到session中 */
$_SESSION['uid'] = $userinfo['uid'];
$_SESSION['name'] = $userinfo['name'];
$_SESSION['userinfo'] = $userinfo;

//* 将用户数据保存到cookie中的一个简单方法 */
$secureKey = 'imooc'; //加密密钥
$str = serialize($userinfo); //将用户信息序列化
//用户信息加密前
$str = base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($secureKey), $str, MCRYPT_MODE_ECB));
//用户信息加密后
//将加密后的用户数据存储到cookie中
setcookie('userinfo', $str);

//当需要使用时进行解密
$str = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5($secureKey), base64_decode($str), MCRYPT_MODE_ECB);
$uinfo = unserialize($str);
echo &quot;解密后的用户信息：&lt;br&gt;&quot;;
print_r($uinfo);

结果：
解密后的用户信息：
Array
(
    [uid] =&gt; 10000
    [name] =&gt; spark
    [email] =&gt; spark@imooc.com
    [sex] =&gt; man
    [age] =&gt; 18
)
</code></pre>
<h1 id="五-文件系统">五、文件系统</h1>
<h2 id="读取文件内容">读取文件内容</h2>
<pre><code class="language-php">$content = file_get_contents('./test.txt');
// file_get_contents，可以将整个文件全部读取到一个字符串中

$content = file_get_contents('./test.txt', null, null, 100, 500);
//可通过参数控制读取内容的开始点以及长度。

echo $content;
</code></pre>
<p>PHP也提供类似于C语言操作文件的方法，使用fopen，fgets，fread等方法，<br>
fgets可以从文件指针中读取一行，freads可以读取指定长度的字符串。</p>
<pre><code class="language-php">$fp = fopen('./text.txt', 'rb');
while(!feof($fp)) {
    echo fgets($fp); //读取一行
}
fclose($fp);
 
$fp = fopen('./text.txt', 'rb');
$contents = '';
while(!feof($fp)) {
    $contents .= fread($fp, 4096); //一次读取4096个字符
}
fclose($fp);
</code></pre>
<p>使用fopen打开的文件，最好使用fclose关闭文件指针，以避免文件句柄被占用。</p>
<h2 id="判断文件是否存在">判断文件是否存在</h2>
<p>is_file与file_exists.</p>
<pre><code class="language-php">file_exists:

//判断文件是否存在，同时也可以判断目录是否存在
$filename = './test.txt';
if (file_exists($filename)) {
    echo file_get_contents($filename);
}

is_file:

//is_file是确切的判断给定的路径是否是一个文件,从函数名可以看出
$filename = './test.txt';
if (is_file($filename)) {
    echo file_get_contents($filename);
}
</code></pre>
<p>is_readable与is_writeable更加精确<br>
在文件是否存在的基础上，判断文件是否可读与可写。</p>
<pre><code class="language-php">//可写
$filename = './test.txt';
if (is_writeable($filename)) {
    file_put_contents($filename, 'test');
}
//可读
if (is_readable($filename)) {
    echo file_get_contents($filename);
}
</code></pre>
<h2 id="取得文件的修改时间">取得文件的修改时间</h2>
<p>文件有很多元属性，包括：文件的所有者、创建时间、修改时间、最后的访问时间等。</p>
<p>fileowner：获得文件的所有者<br>
filectime：获取文件的创建时间<br>
filemtime：获取文件的修改时间<br>
fileatime：获取文件的访问时间</p>
<p>其中最常用的是文件的修改时间，通过文件的修改时间，<br>
可以判断文件的时效性，经常用在静态文件或者缓存数据的更新。</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>=</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>m</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>(</mo></mrow><annotation encoding="application/x-tex">mtime = filemtime(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">m</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mopen">(</span></span></span></span>filename);<br>
echo '修改时间：'.date('Y-m-d H:i:s', filemtime($filename));</p>
<pre><code class="language-php">$filename = '/data/webroot/usercode/code/resource/test.txt';
echo '所有者：'.fileowner($filename).'&lt;br&gt;';
echo '创建时间：'.filectime($filename).'&lt;br&gt;';
echo '修改时间：'.filemtime($filename).'&lt;br&gt;';
echo '最后访问时间：'.fileatime($filename).'&lt;br&gt;';

//给$mtime赋值为文件的修改时间
$mtime = filemtime($filename);
//通过计算时间差 来判断文件内容是否有效
if (time() - $mtime &gt; 3600) {
    echo '&lt;br&gt;缓存已过期';
} else {
    echo file_get_contents($filename);
}
</code></pre>
<h2 id="取得文件的大小">取得文件的大小</h2>
<pre><code class="language-php">$filename = '/data/webroot/usercode/resource/test.txt';
echo filesize($filename);
//没法通过简单的函数来取得目录的大小，目录的大小是该目录下所有子目录以及文件大小的总和，
//因此需要通过递归的方法来循环计算目录的大小。
</code></pre>
<p>详细：https://www.imooc.com/code/578</p>
<h2 id="写入内容到文件">写入内容到文件</h2>
<pre><code class="language-php">$filename = '/data/webroot/usercode/code/test2.txt';
$fp = fopen($filename, 'w');
fwrite($fp, 'hello world'); 
fclose($fp); 

// 或者
$fp = fopen('./test.txt', 'w');
fwrite($fp, 'hello');
fwrite($fp, 'world');
fclose($fp);
</code></pre>
<h2 id="删除文件">删除文件</h2>
<p>跟Unix系统命令类似，PHP使用unlink函数进行文件删除。</p>
<pre><code class="language-php">unlink($filename);
</code></pre>
<p>删除文件夹使用rmdir函数，文件夹必须为空，如果不为空或者没有权限则会提示失败。</p>
<pre><code class="language-php">rmdir($dir);
</code></pre>
<p>如果文件夹中存在文件，可以先循环删除目录中的所有文件，然后再删除该目录，循环删除可以使用glob函数遍历所有文件。</p>
<pre><code class="language-php">foreach (glob(&quot;*&quot;) as $filename) {
   unlink($filename);
}
</code></pre>
<h1 id="六-异常处理">六、异常处理</h1>
<p>从PHP5开始，PHP支持异常处理，异常抛出之后，后面的代码将不会再被执行。<br>
当代码中使用了try catch的时候，抛出的异常会在catch中捕获，否则会直接中断。</p>
<pre><code class="language-php">基本语法
        try{
            //可能出现错误或异常的代码
            //catch表示捕获，Exception是php已定义好的异常类
        } catch(Exception $e){
            //对异常处理，方法：
                //1、自己处理
                //2、不处理，将其再次抛出
        }

//每一个 &quot;throw&quot; 必须对应至少一个 &quot;catch&quot;，当然可以对应多个&quot;catch&quot;
//Catch - &quot;catch&quot; 代码块会捕获异常，并创建一个包含异常信息的对象。

创建可抛出一个异常的函数
function checkNum($number){
     if($number&gt;1){
         throw new Exception(&quot;异常提示-数字必须小于等于1&quot;);
     }
     return true;
 }

//在 &quot;try&quot; 代码块中触发异常
 try{
     checkNum(2);
     //如果异常被抛出，那么下面一行代码将不会被输出
     echo '如果能看到这个提示，说明你的数字小于等于1';
 }catch(Exception $e){
     //捕获异常
     echo '捕获异常: ' .$e-&gt;getMessage();
 }

 检测文件是否存在
$filename = 'test.txt';
try {
    if (!file_exists($filename)) {
      throw new Exception('文件不存在');
    }
} catch(Exception $e) {
    echo $e-&gt;getMessage();
}
</code></pre>
<h2 id="异常处理类">异常处理类</h2>
<p>Exception具有几个基本属性与方法，其中包括了：</p>
<p>message 异常消息内容<br>
code 异常代码<br>
file 抛出异常的文件名<br>
line 抛出异常在该文件的行数</p>
<p>其中常用的方法有：</p>
<p>getTrace 获取异常追踪信息<br>
getTraceAsString 获取异常追踪信息的字符串<br>
getMessage 获取出错信息</p>
<pre><code class="language-php">class MyException extends Exception {
    function getInfo() {
        return '自定义错误信息';
    }
}

try {
    throw new MyException('error');
} catch(Exception $e) {
    echo $e-&gt;getInfo();
}
</code></pre>
<p>详细：https://www.imooc.com/code/601</p>
<h2 id="捕获异常信息">捕获异常信息</h2>
<p>在实际应用中，不会轻易的抛出异常，只有在极端情况或者非常重要的情况下，才会抛出异常，<br>
抛出异常，可以保障程序的正确性与安全，避免导致不可预知的bug。</p>
<pre><code class="language-php">//一般的异常处理流程代码为：
try {
    throw new Exception('wrong');
} catch(Exception $ex) {
    echo 'Error:'.$ex-&gt;getMessage().'&lt;br&gt;';
    echo $ex-&gt;getTraceAsString().'&lt;br&gt;';
}
echo '异常处理后，继续执行其他代码';
</code></pre>
<h2 id="获取错误发生的所在行">获取错误发生的所在行</h2>
<p>在实际应用中，我们通常会获取足够多的异常信息，然后写入到错误日志中。<br>
通过我们需要将报错的文件名、行号、错误信息、异常追踪信息等记录到日志中，以便调试与修复问题。</p>
<pre><code class="language-php">try {
    throw new Exception('wrong');
} catch(Exception $ex) {
    $msg = 'Error:'.$ex-&gt;getMessage().&quot;\n&quot;;
    $msg.= $ex-&gt;getTraceAsString().&quot;\n&quot;;
    $msg.= '异常行号：'.$ex-&gt;getLine().&quot;\n&quot;;
    $msg.= '所在文件：'.$ex-&gt;getFile().&quot;\n&quot;;
    //将异常信息记录到日志中
 PHP异常处理之   file_put_contents('error.log', $msg);
}
</code></pre>
<p>扩展学习：<br>
PHP进阶篇-函数 ：http://www.imooc.com/learn/737<br>
PHP进阶篇-日期时间函数：http://www.imooc.com/learn/698</p>
<hr>
<p>来源：慕课网，内容持续更新中...</p>

                                </div>
                    </article>
                    <!--  -->
                    
                        <div class="next-post">
                            <div class="next">下一篇</div>
                            <a href="https://littlebuzi.github.io/learn_php_1/">
                                <h3 class="post-title">
                                    PHP基础学习笔记(上)
                                </h3>
                            </a>
                        </div>
                        
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">目录</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li><a href="#%E4%B8%80-%E6%95%B0%E7%BB%84%E5%AE%9A%E4%B9%89">一、数组定义</a>
<ul>
<li><a href="#%E7%B4%A2%E5%BC%95%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96">索引数组初始化</a></li>
<li><a href="#%E7%B4%A2%E5%BC%95%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC">索引数组赋值</a></li>
<li><a href="#%E7%B4%A2%E5%BC%95%E6%95%B0%E7%BB%84%E5%86%85%E5%AE%B9">索引数组内容</a></li>
<li><a href="#%E5%BE%AA%E7%8E%AF%E8%AE%BF%E9%97%AE%E7%B4%A2%E5%BC%95%E6%95%B0%E7%BB%84%E9%87%8C%E7%9A%84%E5%80%BC">循环访问索引数组里的值</a></li>
<li><a href="#%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96">关联数组初始化</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1">二、类和对象</a>
<ul>
<li><a href="#%E5%AF%B9%E8%B1%A1%E4%B9%8B%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7">对象之类的属性</a></li>
<li><a href="#%E5%AE%9A%E4%B9%89%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95">定义类的方法</a></li>
<li><a href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%92%8C%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0">构造函数和析构函数</a></li>
<li><a href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6">访问控制</a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E7%BB%A7%E6%89%BF">对象继承</a></li>
<li><a href="#%E9%87%8D%E8%BD%BD">重载</a></li>
<li><a href="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7">高级特性</a></li>
</ul>
</li>
<li><a href="#%E4%B8%89-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">三、正则表达式</a>
<ul>
<li><a href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95">基本语法</a></li>
<li><a href="#%E5%85%83%E5%AD%97%E7%AC%A6%E4%B8%8E%E8%BD%AC%E4%B9%89">元字符与转义</a></li>
<li><a href="#%E8%B4%AA%E5%A9%AA%E6%A8%A1%E5%BC%8F%E4%B8%8E%E6%87%92%E6%83%B0%E6%A8%A1%E5%BC%8F">贪婪模式与懒惰模式</a></li>
<li><a href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D">正则表达式匹配</a></li>
<li><a href="#%E6%9F%A5%E6%89%BE%E6%89%80%E6%9C%89%E5%8C%B9%E9%85%8D%E7%BB%93%E6%9E%9C">查找所有匹配结果</a></li>
<li><a href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E6%90%9C%E7%B4%A2%E5%92%8C%E6%9B%BF%E6%8D%A2">正则表达式的搜索和替换</a></li>
<li><a href="#%E5%B8%B8%E7%94%A8%E6%A1%88%E4%BE%8B">常用案例</a></li>
</ul>
</li>
<li><a href="#%E5%9B%9B-cookie">四、cookie</a>
<ul>
<li><a href="#%E8%AE%BE%E7%BD%AEcookie">设置cookie</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E4%B8%8E%E8%BF%87%E6%9C%9F%E6%97%B6%E9%97%B4">删除与过期时间</a></li>
<li><a href="#%E6%9C%89%E6%95%88%E8%B7%AF%E5%BE%84">有效路径</a></li>
<li><a href="#session%E4%B8%8Ecookie%E7%9A%84%E5%BC%82%E5%90%8C">session与cookie的异同</a></li>
<li><a href="#session%E6%9D%A5%E5%AD%98%E5%82%A8%E7%94%A8%E6%88%B7%E7%9A%84%E7%99%BB%E5%BD%95%E4%BF%A1%E6%81%AF">session来存储用户的登录信息</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">五、文件系统</a>
<ul>
<li><a href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9">读取文件内容</a></li>
<li><a href="#%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8">判断文件是否存在</a></li>
<li><a href="#%E5%8F%96%E5%BE%97%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4">取得文件的修改时间</a></li>
<li><a href="#%E5%8F%96%E5%BE%97%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%A7%E5%B0%8F">取得文件的大小</a></li>
<li><a href="#%E5%86%99%E5%85%A5%E5%86%85%E5%AE%B9%E5%88%B0%E6%96%87%E4%BB%B6">写入内容到文件</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6">删除文件</a></li>
</ul>
</li>
<li><a href="#%E5%85%AD-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">六、异常处理</a>
<ul>
<li><a href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E7%B1%BB">异常处理类</a></li>
<li><a href="#%E6%8D%95%E8%8E%B7%E5%BC%82%E5%B8%B8%E4%BF%A1%E6%81%AF">捕获异常信息</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E9%94%99%E8%AF%AF%E5%8F%91%E7%94%9F%E7%9A%84%E6%89%80%E5%9C%A8%E8%A1%8C">获取错误发生的所在行</a></li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*获取文章目录集合,可通过:header过滤器*/
                var alis = $('.post-content :header');
                /*获取侧边栏目录列表集合**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*获取滚动条到顶部的距离*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*获取锚点集合中的元素分别到顶点的距离*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*高亮显示*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*绑定滚动事件 */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://littlebuzi.github.io//atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
        
            <script>
    window.onload = function() {
        var gitalk = new Gitalk({
            clientID: 'e7c2b33da7e627d57c5a',
            clientSecret: '70bd30bae9adc0e0559d863df193af430483bcd1',
            repo: 'littlebuzi.github.io',
            owner: 'littlebuzi',
            admin: ['littlebuzi'],
            id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
            distractionFreeMode: false // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    }
</script>
                

                    
                                
</body>

</html>